<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gibson Assembly - PrimerWeaver</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            max-width: 1000px;
            margin: 40px auto;
            padding: 20px;
            color: #333;
            background: #f9fafb;
        }
        .container {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1e40af;
            border-bottom: 3px solid #2563eb;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            color: #2563eb;
            margin-top: 2em;
            margin-bottom: 1em;
            font-size: 1.5em;
        }
        h3 {
            color: #3b82f6;
            margin-top: 1.5em;
            margin-bottom: 0.8em;
            font-size: 1.2em;
        }
        h4 {
            color: #60a5fa;
            margin-top: 1.2em;
            margin-bottom: 0.6em;
        }
        p {
            margin-bottom: 1em;
            text-align: justify;
        }
        ul, ol {
            margin-left: 25px;
            margin-bottom: 1em;
        }
        li {
            margin-bottom: 0.5em;
        }
        strong {
            color: #1e40af;
            font-weight: 600;
        }
        code {
            background: #f1f5f9;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #c2410c;
        }
        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1em 0;
        }
        pre code {
            background: transparent;
            color: inherit;
            padding: 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5em 0;
            font-size: 0.95em;
        }
        th, td {
            border: 1px solid #e2e8f0;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #f1f5f9;
            color: #1e40af;
            font-weight: 600;
        }
        tr:nth-child(even) {
            background: #f8fafc;
        }
        .abstract {
            background: #eff6ff;
            border-left: 4px solid #2563eb;
            padding: 20px;
            margin: 2em 0;
            border-radius: 4px;
        }
        .abstract p {
            margin: 0;
            font-style: italic;
        }
        .info-box {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 16px;
            margin: 1.5em 0;
            border-radius: 4px;
        }
        .warning-box {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 16px;
            margin: 1.5em 0;
            border-radius: 4px;
        }
        .section {
            margin-bottom: 2.5em;
        }
        .version-info {
            text-align: center;
            color: #64748b;
            font-size: 0.9em;
            margin-top: 3em;
            padding-top: 2em;
            border-top: 1px solid #e2e8f0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Gibson Assembly Primer Designer</h1>
        
        <div class="abstract">
            <p>The Gibson Assembly module enables the seamless assembly of multiple DNA fragments through rational design of primers with complementary overlap regions. This tool automates primer design for all fragments in the assembly, optimizing overlap lengths and melting temperatures to ensure efficient, high-fidelity assembly. Gibson Assembly is particularly suited for rapid prototyping, constructing complex multi-fragment constructs, and creating large DNA molecules (up to 100 kb) without relying on restriction sites or ligase enzymes.</p>
        </div>

        <div class="section">
            <h2>Quick Start Guide</h2>
            <ol>
                <li><strong>Input Fragments:</strong> Add 2 or more DNA fragments in desired assembly order. Supports FASTA format with auto-extracted sequence names.</li>
                <li><strong>Set Overlap Length:</strong> Configure the overlap region length (default 15-25 bp). Longer overlaps increase assembly fidelity.</li>
                <li><strong>Adjust Temperature Parameters:</strong> Set target Tm for primer design (typically 50-65°C) and modify salt concentrations if needed.</li>
                <li><strong>Design Primers:</strong> Click "Design Primers" to generate optimized primer sequences.</li>
                <li><strong>Review Results:</strong> Examine primer sequences, melting temperatures, quality metrics, and predictions for the assembled product.</li>
                <li><strong>Download Files:</strong> Save primers as FASTA, the full assembled sequence, and a detailed summary report.</li>
            </ol>
        </div>

        <div class="section">
            <h2>Gibson Assembly Principle</h2>
            
            <h3>Assembly Strategy</h3>
            <p>Gibson Assembly (Gibson et al., 2009) is a seamless assembly method that joins DNA fragments without requiring restriction enzymes or ligase in the traditional sense. Instead, it uses:</p>
            <ul>
                <li><strong>Exonuclease (e.g., T5 exonuclease):</strong> Removes 5' overhangs from dsDNA, exposing complementary single-stranded regions (15-25 bp)</li>
                <li><strong>DNA Polymerase (e.g., Phusion):</strong> Fills in the single-stranded gaps using dNTPs</li>
                <li><strong>DNA Ligase (e.g., Taq ligase):</strong> Seals the nick on the newly synthesized complementary strand</li>
            </ul>
            
            <h3>Overlap Design</h3>
            <p>For Gibson Assembly, each adjacent pair of fragments must have complementary overlap regions:</p>
            <ul>
                <li><strong>Fragment i 3' end:</strong> Designed with forward primer to contain first part of overlap</li>
                <li><strong>Fragment i+1 5' end:</strong> Designed with reverse primer to contain complementary overlap</li>
                <li><strong>Overlap Length:</strong> Typical 15-40 bp; longer overlaps (20-25 bp) recommended for improved efficiency</li>
                <li><strong>Complementarity:</strong> Overlaps are perfect complements for annealing during assembly</li>
            </ul>

            <div class="info-box">
                <strong>Optimal Overlap Recommendations:</strong>
                <ul style="margin: 8px 0 0 20px;">
                    <li><strong>15-20 bp:</strong> Standard for most applications, good balance between Tm stability and primer length</li>
                    <li><strong>20-25 bp:</strong> Recommended for difficult assemblies, more stable overlaps</li>
                    <li><strong>&lt;15 bp:</strong> Not recommended; overlaps may be too weak for efficient assembly</li>
                    <li><strong>&gt;40 bp:</strong> Overly long; increases primer cost and may reduce design flexibility</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>Input and Fragment Organization</h2>
            
            <h3>Input Format</h3>
            <p>Supports multi-FASTA format or raw DNA sequences. Each fragment is entered in sequential order for assembly.</p>
            
            <h4>FASTA Format Example:</h4>
            <pre><code>>Vector_backbone
ATGGTGAGCAAGGGCGAGGAGCTGTTCACCGGGGTGGTGCCCATCCTGGTCGAGCTG...
>Insert1
GACGGCGACGTAAACGGCCACAAGTTCAGCGTGTCCGGCGAGGGCGAGGGC...
>Insert2
GATGCCACCTACGGCAAGCTGACCCTGAAGTTCATCTGCACCACCGGCAAGC...</code></pre>
            
            <h3>Fragment Management</h3>
            <ul>
                <li><strong>Add/Remove Fragments:</strong> Add multiple DNA sequences for multi-fragment assembly (2-10 fragments recommended)</li>
                <li><strong>Reorder Fragments:</strong> Use up/down controls to adjust assembly order</li>
                <li><strong>Fragment Names:</strong> Auto-extracted from FASTA headers; used to label primers</li>
                <li><strong>Reverse Complement:</strong> Toggle individual fragments if needed to match desired orientation</li>
            </ul>
        </div>

        <div class="section">
            <h2>Design Parameters</h2>
            
            <table>
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Default</th>
                        <th>Range</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Overlap Length (bp)</strong></td>
                        <td>20</td>
                        <td>15–40</td>
                        <td>Length of complementary overlap region between adjacent fragments. Longer overlaps increase assembly efficiency.</td>
                    </tr>
                    <tr>
                        <td><strong>Target Tm (°C)</strong></td>
                        <td>55</td>
                        <td>40–75</td>
                        <td>Target melting temperature for primer design. Primers will be adjusted to match this temperature.</td>
                    </tr>
                    <tr>
                        <td><strong>Primer Conc. (nM)</strong></td>
                        <td>500</td>
                        <td>50–2000</td>
                        <td>Primer concentration in PCR reaction (not Gibson assembly reaction). Used for Tm calculation.</td>
                    </tr>
                    <tr>
                        <td><strong>Na⁺ Conc. (mM)</strong></td>
                        <td>50</td>
                        <td>0–200</td>
                        <td>Monovalent cation concentration for salt-corrected Tm calculation.</td>
                    </tr>
                    <tr>
                        <td><strong>Mg²⁺ Conc. (mM)</strong></td>
                        <td>2.0</td>
                        <td>0–10</td>
                        <td>Divalent cation concentration for Tm calculation. Affects polymerase processivity.</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2>Primer Design Algorithm</h2>
            
            <h3>Primer Types</h3>
            <p>Gibson Assembly requires four types of primers per internal junction:</p>
            
            <h4>Terminal Primers</h4>
            <ul>
                <li><strong>Forward Primer (F1):</strong> Binds to start of first fragment</li>
                <li><strong>Reverse Primer (RN):</strong> Binds to end of last fragment</li>
                <li><strong>No Overlap:</strong> Terminal primers have no overlap region, only core binding sequence</li>
            </ul>
            
            <h4>Junction Primers</h4>
            <ul>
                <li><strong>F (Forward):</strong> Binds to start of each intermediate fragment, carries overlap from previous fragment</li>
                <li><strong>R (Reverse):</strong> Binds to end of each intermediate fragment, carries overlap to next fragment</li>
                <li><strong>Structure:</strong> <code>Primer = overlap_region + core_binding_region</code></li>
            </ul>
            
            <h3>Design Strategy</h3>
            <ol>
                <li><strong>Define Overlap Boundaries:</strong>
                    <ul>
                        <li>For fragment i: last N bp (where N = overlap length) constitute the forward overlap</li>
                        <li>For fragment i+1: first N bp constitute the reverse overlap (reverse complement)</li>
                    </ul>
                </li>
                <li><strong>Calculate Core Binding Regions:</strong>
                    <ul>
                        <li>Determine primer length needed to achieve target Tm</li>
                        <li>Use binary search to find optimal length (typically 18-30 bp)</li>
                    </ul>
                </li>
                <li><strong>Construct Full Primers:</strong>
                    <ul>
                        <li>Forward primer: overlap + core binding region</li>
                        <li>Reverse primer: core binding region + overlap (reverse complemented)</li>
                    </ul>
                </li>
                <li><strong>Quality Assessment:</strong>
                    <ul>
                        <li>Verify GC content (40-60% optimal)</li>
                        <li>Check for secondary structures (hairpins, self-dimers)</li>
                        <li>Analyze cross-primer interactions</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="section">
            <h2>Quality Metrics and Assessment</h2>
            
            <h3>Primer Quality Indicators</h3>
            <table>
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Description</th>
                        <th>Optimal Range</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Length</strong></td>
                        <td>Total primer length (core + overlap)</td>
                        <td>25–60 bp</td>
                    </tr>
                    <tr>
                        <td><strong>GC Content</strong></td>
                        <td>Percentage of G and C bases</td>
                        <td>40–60%</td>
                    </tr>
                    <tr>
                        <td><strong>Core Tm</strong></td>
                        <td>Melting temperature of core binding region</td>
                        <td>Target ± 2°C</td>
                    </tr>
                    <tr>
                        <td><strong>Overlap Tm</strong></td>
                        <td>Melting temperature of overlap region</td>
                        <td>50–65°C</td>
                    </tr>
                    <tr>
                        <td><strong>Homopolymer</strong></td>
                        <td>Runs of identical consecutive bases</td>
                        <td>&lt;4 bp recommended</td>
                    </tr>
                    <tr>
                        <td><strong>Hairpin</strong></td>
                        <td>Intramolecular secondary structure</td>
                        <td>ΔG &gt; -3 kcal/mol (none/weak)</td>
                    </tr>
                    <tr>
                        <td><strong>Self-Dimer</strong></td>
                        <td>Primer self-complementarity</td>
                        <td>ΔG &gt; -5 kcal/mol</td>
                    </tr>
                    <tr>
                        <td><strong>Cross-Dimer</strong></td>
                        <td>Complementarity with other primers</td>
                        <td>ΔG &gt; -5 kcal/mol</td>
                    </tr>
                </tbody>
            </table>

            <div class="warning-box">
                <strong>Critical Quality Issues:</strong>
                <ul style="margin: 8px 0 0 20px;">
                    <li><strong>Overlap Tm &lt; 45°C:</strong> Overlap may be too weak for exonuclease activity. Consider longer overlaps or adjusting salt concentration.</li>
                    <li><strong>Core Tm &gt; 65°C:</strong> May reduce primer specificity. Shorter core regions recommended.</li>
                    <li><strong>Strong Secondary Structures:</strong> ΔG ≤ -7 kcal/mol dimers can sequester primers and reduce assembly efficiency.</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>Results and Output</h2>
            
            <h3>Primer Table</h3>
            <p>Comprehensive display of all designed primers showing:</p>
            <ul>
                <li>Primer name and associated fragment</li>
                <li>Full sequence with overlap regions highlighted</li>
                <li>Length, GC%, Core Tm, and Overlap Tm</li>
                <li>Quality badges (OK, Warn, Bad) for secondary structures</li>
                <li>Color coding by fragment for easy identification</li>
            </ul>

            <h3>Assembled Sequence Prediction</h3>
            <ul>
                <li><strong>Full Assembly:</strong> Complete predicted sequence after PCR amplification of all fragments</li>
                <li><strong>Primer Binding Sites:</strong> Visual highlighting of where each primer binds</li>
                <li><strong>FASTA Format:</strong> Complete sequence with header for easy import into other tools</li>
                <li><strong>Download Option:</strong> Save assembled sequence for reference or vector construction</li>
            </ul>

            <h3>Assembly Visualization</h3>
            <ul>
                <li><strong>Fragment Map:</strong> Diagram showing relative positions and sizes of fragments</li>
                <li><strong>Overlap Visualization:</strong> Detailed view of complementary overlap regions</li>
                <li><strong>Primer Annotations:</strong> Indicates which primers target which fragments</li>
            </ul>
        </div>

        <div class="section">
            <h2>Thermodynamic Calculations</h2>
            
            <h3>Melting Temperature (Tm) Model</h3>
            <p>Uses nearest-neighbor thermodynamic parameters with salt correction:</p>
            
            <div style="background: #f8fafc; padding: 15px; border-radius: 8px; margin: 1em 0;">
                <p style="text-align: center; font-family: 'Times New Roman', serif; font-size: 1.1em; margin: 0;">
                    <em>T<sub>m</sub></em> = <span style="font-size: 1.3em;">ΔH°</span> / (ΔS° + R × ln(<em>C<sub>T</sub></em>/4)) - 273.15 + 16.6 × log[Na<sup>+</sup><sub>eq</sub>]
                </p>
            </div>

            <p><strong>Key Parameters:</strong></p>
            <ul>
                <li>ΔH° and ΔS°: Nearest-neighbor enthalpy and entropy values (SantaLucia, 1998)</li>
                <li>C<sub>T</sub>: Total primer concentration (default 500 nM)</li>
                <li>Na<sup>+</sup><sub>eq</sub>: Equivalent monovalent salt, accounting for Mg²⁺</li>
            </ul>

            <h3>Secondary Structure Analysis</h3>
            <p>Hairpin and dimer ΔG calculated using the same nearest-neighbor model with consideration for:</p>
            <ul>
                <li>Continuous base-pairing in complementary regions</li>
                <li>Mismatches and wobble pairs in partially complementary regions</li>
                <li>Entropic penalties for loop formation (hairpins)</li>
                <li>Terminal mismatch effects</li>
            </ul>

            <div class="info-box">
                <strong>Classification Thresholds:</strong>
                <ul style="margin: 8px 0 0 20px;">
                    <li><strong>None:</strong> ΔG &gt; -3 kcal/mol (minimal risk)</li>
                    <li><strong>Weak:</strong> -5 &lt; ΔG ≤ -3 kcal/mol (acceptable, minor concern)</li>
                    <li><strong>Moderate:</strong> -7 &lt; ΔG ≤ -5 kcal/mol (significant concern; review recommended)</li>
                    <li><strong>Strong:</strong> ΔG ≤ -7 kcal/mol (significant risk; redesign recommended)</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>Practical Assembly Considerations</h2>
            
            <h3>PCR Amplification</h3>
            <p>Before Gibson Assembly, all fragments must be PCR-amplified using the designed primers. Best practices:</p>
            <ul>
                <li><strong>Polymerase:</strong> Use high-fidelity polymerase (e.g., Phusion, Q5) to minimize errors</li>
                <li><strong>Annealing Temperature:</strong> Use the core primer Tm (not overlap Tm) for PCR annealing temperature</li>
                <li><strong>Product Purification:</strong> Purify PCR products thoroughly to remove polymerase, dNTPs, and templates</li>
                <li><strong>Fragment Concentration:</strong> Normalize fragment concentrations to ~100-200 ng/μL</li>
            </ul>

            <h3>Gibson Assembly Reaction</h3>
            <ul>
                <li><strong>Fragment Ratio:</strong> Use roughly equal molar amounts of all fragments (typically 50-100 fmol each)</li>
                <li><strong>Master Mix:</strong> Use commercial Gibson Assembly Master Mix (contains exonuclease, polymerase, ligase, and buffers)</li>
                <li><strong>Incubation:</strong> Typically 50°C for 15-60 minutes (check master mix instructions)</li>
                <li><strong>Product:</strong> Can be directly transformed into competent cells without further purification</li>
            </ul>

            <div class="info-box">
                <strong>Assembly Efficiency Tips:</strong>
                <ul style="margin: 8px 0 0 20px;">
                    <li>Longer overlaps (20-25 bp) increase efficiency over minimal overlaps (15 bp)</li>
                    <li>Avoid high GC content (&gt;70%) in overlap regions, which can inhibit exonuclease activity</li>
                    <li>Homopolymer runs &gt;4 bp can reduce exonuclease processivity</li>
                    <li>For difficult assemblies, increase fragment concentration or incubation time</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>Troubleshooting</h2>
            
            <h3>Common Issues</h3>
            <table>
                <thead>
                    <tr>
                        <th>Problem</th>
                        <th>Likely Cause</th>
                        <th>Solution</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>No colonies after transformation</td>
                        <td>Failed PCR amplification or assembly</td>
                        <td>Verify PCR products by gel electrophoresis; check primer specificity</td>
                    </tr>
                    <tr>
                        <td>Very few colonies</td>
                        <td>Low assembly efficiency, weak overlaps</td>
                        <td>Increase overlap length; verify primer Tm values; increase incubation time</td>
                    </tr>
                    <tr>
                        <td>High proportion of single-fragment clones</td>
                        <td>Incomplete assembly or recircularization of vector alone</td>
                        <td>Check overlap complementarity; ensure equal molar fragment ratios; dephosphorylate vector if used alone</td>
                    </tr>
                    <tr>
                        <td>Incorrect insert orientation</td>
                        <td>Bidirectional compatibility of fragments</td>
                        <td>Use directional overlaps; ensure forward/reverse primer design is correct</td>
                    </tr>
                    <tr>
                        <td>Sequencing errors in assembled product</td>
                        <td>PCR amplification errors</td>
                        <td>Use high-fidelity polymerase; consider running extra PCR cycles</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="version-info">
            <p><strong>Gibson Assembly Module v1.0.1</strong></p>
            <p>Documentation for PrimerWeaver v1.1.11</p>
        </div>
    </div>
</body>
</html>