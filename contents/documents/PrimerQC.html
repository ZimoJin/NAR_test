<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Primer QC - PrimerWeaver</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            max-width: 1000px;
            margin: 40px auto;
            padding: 20px;
            color: #333;
            background: #f9fafb;
        }
        .container {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1e40af;
            border-bottom: 3px solid #2563eb;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            color: #2563eb;
            margin-top: 2em;
            margin-bottom: 1em;
            font-size: 1.5em;
        }
        h3 {
            color: #3b82f6;
            margin-top: 1.5em;
            margin-bottom: 0.8em;
            font-size: 1.2em;
        }
        h4 {
            color: #60a5fa;
            margin-top: 1.2em;
            margin-bottom: 0.6em;
        }
        p {
            margin-bottom: 1em;
            text-align: justify;
        }
        ul, ol {
            margin-left: 25px;
            margin-bottom: 1em;
        }
        li {
            margin-bottom: 0.5em;
        }
        strong {
            color: #1e40af;
            font-weight: 600;
        }
        code {
            background: #f1f5f9;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #c2410c;
        }
        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1em 0;
        }
        pre code {
            background: transparent;
            color: inherit;
            padding: 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5em 0;
            font-size: 0.95em;
        }
        th, td {
            border: 1px solid #e2e8f0;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #f1f5f9;
            color: #1e40af;
            font-weight: 600;
        }
        tr:nth-child(even) {
            background: #f8fafc;
        }
        .abstract {
            background: #eff6ff;
            border-left: 4px solid #2563eb;
            padding: 20px;
            margin: 2em 0;
            border-radius: 4px;
        }
        .abstract p {
            margin: 0;
            font-style: italic;
        }
        .highlight {
            background: #fef3c7;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .section {
            margin-bottom: 2.5em;
        }
        .reference {
            font-size: 0.9em;
            margin-left: 20px;
            margin-bottom: 0.5em;
        }
        .version-info {
            text-align: center;
            color: #64748b;
            font-size: 0.9em;
            margin-top: 3em;
            padding-top: 2em;
            border-top: 1px solid #e2e8f0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 id="d-qc">Primer QC: A Comprehensive Web-Based Tool for PCR Primer Quality Assessment</h1>

        <div class="abstract">
            <p><strong>Abstract:</strong> Primer QC is an advanced web-based tool for comprehensive quality control of PCR primers. It provides in-silico evaluation of primer properties including thermodynamic parameters, secondary structure formation, and primer-pair compatibility. The tool employs state-of-the-art nearest-neighbor thermodynamic models and advanced algorithms for dimer and hairpin detection, making it an essential utility for validating primers before experimental use.</p>
        </div>

        <div class="section">
            <h2>Introduction</h2>
            <p>Polymerase Chain Reaction (PCR) is a fundamental technique in molecular biology, and the success of PCR experiments critically depends on primer quality. Poor primer design can lead to non-specific amplification, primer-dimer formation, or complete PCR failure. Primer QC addresses this need by providing a comprehensive, user-friendly web interface for evaluating primer sequences using established thermodynamic principles and computational methods.</p>
        </div>

        <div class="section">
            <h2>Features</h2>

            <h3>1. Core Thermodynamic Calculations</h3>
            
            <h4>Melting Temperature (Tm) Calculation:</h4>
            <ul>
                <li>Implements the unified nearest-neighbor thermodynamic model (SantaLucia, 1998; Allawi &amp; SantaLucia, 1997)</li>
                <li>Accounts for salt correction using the formula: <code>Tm = ΔH° / (ΔS° + R × ln(C/4)) - 273.15 + 16.6 × log₁₀([Na⁺] + 0.7 × [Mg²⁺])</code></li>
                <li>Supports monovalent (Na⁺) and divalent (Mg²⁺) cation concentrations</li>
                <li>Considers primer concentration in the calculation</li>
                <li>Provides Tm values with reference to user-specified target Tm</li>
            </ul>

            <h4>GC Content Analysis:</h4>
            <ul>
                <li>Calculates percentage of G and C bases in the primer sequence</li>
                <li>Supports IUPAC degenerate base codes (R, Y, S, W, K, M, B, D, H, V, N)</li>
                <li>Identifies primers with suboptimal GC content (typically 40-60% recommended)</li>
            </ul>

            <h3>2. Secondary Structure Analysis</h3>

            <h4>Self-Dimer Detection:</h4>
            <ul>
                <li>Comprehensive scanning for potential self-dimer formation</li>
                <li>Calculates Gibbs free energy (ΔG) for dimer structures</li>
                <li>Classifies dimers as:
                    <ul>
                        <li><strong>None</strong>: No significant dimer formation (ΔG &gt; -3 kcal/mol)</li>
                        <li><strong>Weak</strong>: Moderate stability (-5 &lt; ΔG ≤ -3 kcal/mol)</li>
                        <li><strong>Moderate</strong>: Significant stability (-7 &lt; ΔG ≤ -5 kcal/mol)</li>
                        <li><strong>Strong</strong>: High stability (ΔG ≤ -7 kcal/mol)</li>
                    </ul>
                </li>
                <li>Special attention to 3'-end interactions, which are particularly problematic for PCR</li>
            </ul>

            <h4>Hairpin Detection:</h4>
            <ul>
                <li>Identifies potential hairpin structures with loop sizes from 3 to 9 nucleotides</li>
                <li>Incorporates loop entropy penalties based on SantaLucia (2004) parameters</li>
                <li>Calculates ΔG for hairpin formation, accounting for:
                    <ul>
                        <li>Base-pairing in the stem region</li>
                        <li>Loop size and entropy</li>
                        <li>Terminal mismatches</li>
                    </ul>
                </li>
                <li>Classifies hairpins using the same energy thresholds as dimers</li>
            </ul>

            <h4>Cross-Dimer Analysis:</h4>
            <ul>
                <li>Evaluates potential dimer formation between forward and reverse primers</li>
                <li>Critical for primer pair validation</li>
                <li>Provides visual alignment of dimer structures when detected</li>
                <li>Warns about 3'-end interactions that can cause primer-dimer artifacts</li>
            </ul>

            <h3>3. Primer Pair Evaluation</h3>

            <h4>Reliability Score:</h4>
            <ul>
                <li>Composite score (0-100) combining multiple quality metrics:
                    <ul>
                        <li>Individual primer scores (45% weight each)</li>
                        <li>Cross-dimer penalty/adjustment</li>
                        <li>Tm difference penalty (if ΔTm &gt; 5°C)</li>
                    </ul>
                </li>
                <li>Classification:
                    <ul>
                        <li><strong>Excellent</strong> (≥85): High-quality primer pair, ready for use</li>
                        <li><strong>Acceptable</strong> (65-84): Good quality with minor concerns</li>
                        <li><strong>Risky</strong> (&lt;65): Significant issues detected, review recommended</li>
                    </ul>
                </li>
            </ul>

            <h4>Tm Compatibility:</h4>
            <ul>
                <li>Calculates and displays the difference in melting temperatures between forward and reverse primers</li>
                <li>Flags pairs with ΔTm &gt; 5°C, which may require gradient PCR or optimization</li>
            </ul>

            <h3>4. Additional Quality Metrics</h3>

            <h4>3'-End Stability (3' Clamp):</h4>
            <ul>
                <li>Evaluates the 3'-terminal base pair stability</li>
                <li>G/C clamp (stronger) preferred over A/T clamp</li>
                <li>Critical for PCR efficiency as extension initiates at the 3' end</li>
            </ul>

            <h4>Homopolymer Detection:</h4>
            <ul>
                <li>Identifies runs of identical bases (default threshold: 4 consecutive bases)</li>
                <li>Long homopolymers can cause slippage and non-specific amplification</li>
            </ul>

            <h4>IUPAC Degenerate Base Support:</h4>
            <ul>
                <li>Full support for ambiguous DNA bases</li>
                <li>Tm and ΔG calculations use the most stable (worst-case) variant</li>
                <li>Clearly marked in results with asterisk (*)</li>
            </ul>
        </div>

        <div class="section">
            <h2>Algorithm Details</h2>

            <h3>Thermodynamic Parameters</h3>
            <p>The tool uses the unified nearest-neighbor (NN) parameters from SantaLucia (1998) and Allawi &amp; SantaLucia (1997):</p>

            <table>
                <thead>
                    <tr>
                        <th>Nearest Neighbor</th>
                        <th>ΔH° (kcal/mol)</th>
                        <th>ΔS° (cal/mol·K)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>AA/TT</td>
                        <td>-7.9</td>
                        <td>-22.2</td>
                    </tr>
                    <tr>
                        <td>AT/TA</td>
                        <td>-7.2</td>
                        <td>-20.4 / -21.3</td>
                    </tr>
                    <tr>
                        <td>CA/TG</td>
                        <td>-8.5</td>
                        <td>-22.7</td>
                    </tr>
                    <tr>
                        <td>GT/AC</td>
                        <td>-8.4</td>
                        <td>-22.4</td>
                    </tr>
                    <tr>
                        <td>CT/AG</td>
                        <td>-7.8</td>
                        <td>-21.0</td>
                    </tr>
                    <tr>
                        <td>GA/TC</td>
                        <td>-8.2</td>
                        <td>-22.2</td>
                    </tr>
                    <tr>
                        <td>CG/GC</td>
                        <td>-10.6 / -9.8</td>
                        <td>-27.2 / -24.4</td>
                    </tr>
                    <tr>
                        <td>GG/CC</td>
                        <td>-8.0</td>
                        <td>-19.9</td>
                    </tr>
                </tbody>
            </table>

            <h3>Dimer Scanning Algorithm</h3>
            <ol>
                <li><strong>Sliding Window Approach:</strong>
                    <ul>
                        <li>Examines all possible alignments between primer sequences</li>
                        <li>Considers both direct and reverse complement orientations</li>
                        <li>Tests alignments with gaps and overhangs</li>
                    </ul>
                </li>
                <li><strong>Energy Calculation:</strong>
                    <ul>
                        <li>Sums nearest-neighbor ΔH° and ΔS° values for matched regions</li>
                        <li>Applies salt correction</li>
                        <li>Accounts for terminal mismatches and bulges</li>
                    </ul>
                </li>
                <li><strong>3'-End Interaction Detection:</strong>
                    <ul>
                        <li>Special flagging when dimer interactions involve the 3' end</li>
                        <li>Critical for PCR as extension starts at the 3' terminus</li>
                    </ul>
                </li>
            </ol>

            <h3>Hairpin Detection Algorithm</h3>
            <ol>
                <li><strong>Stem Identification:</strong>
                    <ul>
                        <li>Searches for complementary regions within the primer</li>
                        <li>Minimum stem length: 3 base pairs</li>
                        <li>Allows for internal loops and bulges</li>
                    </ul>
                </li>
                <li><strong>Loop Entropy Penalty:</strong>
                    <ul>
                        <li>Applies size-dependent entropy penalties:
                            <ul>
                                <li>3-nt loop: +5.7 kcal/mol</li>
                                <li>4-nt loop: +5.6 kcal/mol</li>
                                <li>5-nt loop: +4.9 kcal/mol</li>
                                <li>6-nt loop: +4.4 kcal/mol</li>
                                <li>7-9-nt loops: +4.5-4.6 kcal/mol</li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li><strong>Energy Threshold:</strong>
                    <ul>
                        <li>Hairpins with ΔG ≤ -3 kcal/mol are considered significant</li>
                        <li>More stable hairpins (ΔG ≤ -7 kcal/mol) are flagged as critical</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="section">
            <h2>Input Format</h2>

            <h3>Supported Formats</h3>

            <h4>1. FASTA Format:</h4>
            <pre><code>&gt;primer1-F
ATGGTGAGRAAGGGCGAGGAG
&gt;primer1-R
CTTGTACAGCTCGTCCATGCC</code></pre>

            <h4>2. Raw Sequences (one per line):</h4>
            <pre><code>ATGGTGAGRAAGGGCGAGGAG
CTTGTACAGCTCGTCCATGCC</code></pre>

            <h4>3. Primer Name Formats:</h4>
            <p>The tool automatically recognizes and pairs primers using flexible naming conventions:</p>
            <ul>
                <li><code>Target1-F / Target1-R</code> (with dash)</li>
                <li><code>Target1_F / Target1_R</code> (with underscore)</li>
                <li><code>Target1F / Target1R</code> (no separator)</li>
                <li><code>Target1-Forward / Target1-Reverse</code> (full words)</li>
                <li><code>Target1_Forward / Target1_Reverse</code> (full words with underscore)</li>
                <li><code>Target1-fwd / Target1-rev</code> (abbreviated)</li>
                <li><code>Target1_FWD / Target1_REV</code> (uppercase abbreviated)</li>
            </ul>

            <h3>Input Parameters</h3>
            <ul>
                <li><strong>Na⁺ concentration</strong> (mM): Monovalent cation concentration (default: 50 mM)</li>
                <li><strong>Mg²⁺ concentration</strong> (mM): Divalent cation concentration (default: 2.0 mM)</li>
                <li><strong>Primer concentration</strong> (nM): Primer concentration in PCR reaction (default: 500 nM)</li>
                <li><strong>Target Tm</strong> (°C): Target melting temperature for evaluation (default: 60°C)</li>
            </ul>
        </div>

        <div class="section">
            <h2>Output</h2>

            <h3>Per-Primer Metrics Table</h3>
            <p>For each primer, the tool displays:</p>

            <table>
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Primer</td>
                        <td>Primer name/label (with * if degenerate bases present)</td>
                    </tr>
                    <tr>
                        <td>Len</td>
                        <td>Primer length (nucleotides)</td>
                    </tr>
                    <tr>
                        <td>GC%</td>
                        <td>GC content percentage</td>
                    </tr>
                    <tr>
                        <td>Tm (Δ)</td>
                        <td>Melting temperature and difference from target</td>
                    </tr>
                    <tr>
                        <td>3' clamp</td>
                        <td>Terminal base pair (G/C or A/T)</td>
                    </tr>
                    <tr>
                        <td>Homopoly</td>
                        <td>Homopolymer run detection (OK or High)</td>
                    </tr>
                    <tr>
                        <td>Hairpin</td>
                        <td>Hairpin structure classification</td>
                    </tr>
                    <tr>
                        <td>ΔG(3' 5bp)</td>
                        <td>Gibbs free energy of 3'-end 5-base window</td>
                    </tr>
                    <tr>
                        <td>Self-dimer</td>
                        <td>Self-dimer classification</td>
                    </tr>
                    <tr>
                        <td>Cross-dimer</td>
                        <td>Cross-dimer classification (for pairs)</td>
                    </tr>
                </tbody>
            </table>

            <h3>Reliability Score</h3>
            <ul>
                <li>Large, color-coded numerical score (0-100)</li>
                <li>Color coding:
                    <ul>
                        <li><strong style="color: #16a34a;">Green</strong>: Excellent (≥85)</li>
                        <li><strong style="color: #d97706;">Orange</strong>: Acceptable (65-84)</li>
                        <li><strong style="color: #b91c1c;">Red</strong>: Risky (&lt;65)</li>
                    </ul>
                </li>
                <li>Accompanying text label and ΔTm information</li>
            </ul>

            <h3>Predicted Structures</h3>
            <p>When dimers or hairpins are detected, the tool provides:</p>
            <ul>
                <li>Visual alignment of the structure</li>
                <li>Calculated ΔG value</li>
                <li>Classification (None, Weak, Moderate, Strong)</li>
                <li>Warning flags for 3'-end interactions</li>
            </ul>
        </div>

        <div class="section">
            <h2>Use Cases</h2>
            <ol>
                <li><strong>Pre-Order Validation:</strong>
                    <ul>
                        <li>Validate primers from publications or databases before ordering</li>
                        <li>Check compatibility of existing primer pairs</li>
                    </ul>
                </li>
                <li><strong>Troubleshooting:</strong>
                    <ul>
                        <li>Diagnose PCR failures by identifying problematic primer properties</li>
                        <li>Understand why certain primers perform poorly</li>
                    </ul>
                </li>
                <li><strong>Primer Optimization:</strong>
                    <ul>
                        <li>Compare multiple primer candidates</li>
                        <li>Identify specific issues (e.g., strong dimers, poor GC content)</li>
                    </ul>
                </li>
                <li><strong>Educational:</strong>
                    <ul>
                        <li>Learn about primer design principles</li>
                        <li>Understand thermodynamic parameters affecting PCR</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="section">
            <h2>Technical Implementation</h2>
            <ul>
                <li><strong>Client-side Processing:</strong> All calculations performed in the browser using JavaScript</li>
                <li><strong>No Data Transmission:</strong> Primer sequences never leave the user's device</li>
                <li><strong>Real-time Analysis:</strong> Instant results upon clicking "Run QC"</li>
                <li><strong>IUPAC Support:</strong> Full handling of degenerate bases</li>
                <li><strong>Responsive Design:</strong> Works on desktop and mobile devices</li>
            </ul>
        </div>

        <div class="section">
            <h2>Limitations and Considerations</h2>
            <ol>
                <li><strong>Thermodynamic Models:</strong>
                    <ul>
                        <li>Based on in-vitro measurements; in-vivo conditions may vary</li>
                        <li>Assumes standard PCR buffer conditions</li>
                    </ul>
                </li>
                <li><strong>Secondary Structure Prediction:</strong>
                    <ul>
                        <li>Predicts most stable structures; alternative conformations possible</li>
                        <li>Does not account for protein binding or other factors</li>
                    </ul>
                </li>
                <li><strong>IUPAC Degenerate Bases:</strong>
                    <ul>
                        <li>Uses worst-case scenario (most stable variant)</li>
                        <li>May overestimate problems for degenerate primers</li>
                    </ul>
                </li>
                <li><strong>Primer Concentration:</strong>
                    <ul>
                        <li>Assumes equal concentrations for forward and reverse primers</li>
                        <li>Asymmetric concentrations not currently modeled</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="section">
            <h2>Future Enhancements</h2>
            <ul>
                <li>Support for primer concentration gradients</li>
                <li>Integration with primer design modules</li>
                <li>Batch processing for multiple primer sets</li>
                <li>Export functionality for results</li>
                <li>Comparison mode for multiple primer candidates</li>
            </ul>
        </div>

        <div class="section">
            <h2>Citation</h2>
            <p>If you use Primer QC in your research, please cite:</p>
            <p><strong>PrimerWeaver: An Integrated Web Server for Primer Design and Quality Control</strong></p>
            <p><em>[Full citation details to be added upon publication]</em></p>
        </div>

        <div class="section">
            <h2>References</h2>
            <ol>
                <li class="reference">SantaLucia, J. (1998). A unified view of polymer, dumbbell, and oligonucleotide DNA nearest-neighbor thermodynamics. <em>Proc. Natl. Acad. Sci. USA</em>, 95(4), 1460-1465.</li>
                <li class="reference">Allawi, H. T., &amp; SantaLucia, J. (1997). Thermodynamics and NMR of internal G·T mismatches in DNA. <em>Biochemistry</em>, 36(34), 10581-10594.</li>
                <li class="reference">SantaLucia, J. (2004). The thermodynamics of DNA structural motifs. <em>Annu. Rev. Biophys. Biomol. Struct.</em>, 33, 415-440.</li>
            </ol>
        </div>

        <div class="section">
            <h2>Contact and Support</h2>
            <p>For questions, bug reports, or feature requests, please visit the PrimerWeaver website or contact the development team.</p>
        </div>

        <div class="version-info">
            <p><strong>Version:</strong> 4.1<br>
            <strong>Last Updated:</strong> 2024<br>
            <strong>License:</strong> [To be specified]</p>
        </div>
    </div>
</body>
</html>
